// Add styling hardcoded
jQuery("head").append('<style type="text/css">.hamburger-toggler{position:fixed;top:calc(((85vw * (264 / 1500)) - 36px)/ 2);top:-moz-calc(((85vw * (264 / 1500)) - 36px)/ 2);top:-webkit-calc(((85vw * (264 / 1500)) - 36px)/ 2);top:-o-calc(((85vw * (264 / 1500)) - 36px)/ 2);right:calc((15vw - 36px)/ 2);right:-moz-calc((15vw - 36px)/ 2);right:-webkit-calc((15vw - 36px)/ 2);right:-o-calc((15vw - 36px)/ 2);color:#fff;z-index:999;height:36px;width:36px;outline:0;cursor:pointer;display:flex;align-items:center;appearance:none;border:none;background:0 0;padding:0;text-align:unset}@media(max-width:768px){.small--no-padding{padding:0}.small--no-rounding{border-radius:0}.small--no-bottom-margin{margin-bottom:0}.small--no-margin{margin:0}.small--display-block{display:block}.small--hidden{display:none}}@media(min-width:992px){.from-medium--default-rounding{border-radius:10px}}@media(max-width:991px){.medium--white-background{background-color:#fff}.medium--black-text{color:#000}}.remove-rounding{border-radius:0}.remove-padding{padding:0}.remove-margin{margin:0}.remove-vertical-padding{padding-top:0;padding-bottom:0}.rotate--half{transform:rotate(180deg)}.header-menu-fix{width:100%}@media(max-width:768px){.sticky-banner{position:fixed;box-shadow:rgba(0,0,0,.5) 0 3px 11px 0;z-index:1000}.header-menu-fix{width:85%}#content{margin-top:-moz-calc((85vw * (264 / 1500)) - 50px);margin-top:-webkit-calc((85vw * (264 / 1500)) - 50px);margin-top:-o-calc((85vw * (264 / 1500)) - 50px);margin-top:calc((85vw * (264 / 1500)) - 50px)}#menu-menu-1{margin:0 8px;font-size:1.4em}#menu-menu-1>li>a{font-weight:700}#navigationMenu{position:fixed;left:-100%;z-index:998;text-decoration:none;overflow:scroll;height:100%;color:#fff;background:#57007f;min-width:max(360px,80vw);min-height:calc(100vh - (85vw * (264 / 1500)));min-height:-moz-calc(100vh - (85vw * (264 / 1500)));min-height:-webkit-calc(100vh - (85vw * (264 / 1500)));min-height:-o-calc(100vh - (85vw * (264 / 1500)));top:calc(85vw * (264 / 1500));top:-moz-calc(85vw * (264 / 1500));top:-webkit-calc(85vw * (264 / 1500));top:-o-calc(85vw * (264 / 1500))}.navbar-default .navbar-nav>.active>a,.navbar-default .navbar-nav>.open>a{background:#3188e7!important;-webkit-box-shadow:none!important;box-shadow:none!important}.navigation__menu{padding:24px 16px 8px 16px;display:flex;flex-direction:column;justify-content:center}}@media(min-width:769px){.margin-top-content-fix{margin-top:8px}.dropdown--responsive{min-width:160px;position:absolute;z-index:1000;font-weight:400;line-height:1.42857143;padding:0}li:hover>.dropdown--responsive{display:block}.dropdow__item--responsive{padding-right:5px;padding-left:5px;background-color:#57007f;border-bottom:1px solid #fff}.dropdow__item--responsive:first-child{border-radius:10px 10px 0 0}.dropdow__item--responsive:last-child{border-bottom:none;border-radius:0 0 10px 10px}}.hamburger-toggler span,.hamburger-toggler span::after,.hamburger-toggler span::before{position:absolute;content:"";width:36px;height:4.5px;background:#fafafa;border-radius:20px;transition:.5s cubic-bezier(.77,0,.175,1)}.hamburger-toggler span::before{top:-12px}.hamburger-toggler span::after{top:12px}.hamburger-toggler.active>span{background:0 0}.hamburger-toggler.active>span::after,.hamburger-toggler.active>span::before{background:#fff;top:0}.hamburger-toggler.active>span::before{transform:rotate(-225deg)}.hamburger-toggler.active>span::after{transform:rotate(225deg)}.lock-scroll{overflow:hidden}@keyframes navigationUnfoldShadowAnimation{0%{box-shadow:-25vw 0 300px 0 rgba(0,0,0,.5)}100%{box-shadow:60vw 0 20px 15px rgba(0,0,0,.5)}}@keyframes navigationFoldsShadowAnimation{0%{box-shadow:-25vw 0 300px 0 rgba(0,0,0,.5)}100%{box-shadow:30vw 0 20px 15px rgba(0,0,0,.5)}}.navigation-unfolds{animation-name:navigationUnfoldShadowAnimation;animation-duration:150ms;animation-iteration-count:1;animation-timing-function:linear;animation-fill-mode:forwards}.navigation-folds{animation-name:navigationFoldsShadowAnimation;animation-duration:.3s;animation-iteration-count:1;animation-direction:reverse;animation-timing-function:linear}.button--highlight{background-color:#57007f}#floatingChatButton{cursor:pointer;border-radius:50%;min-width:60px;min-height:60px;width:60px;z-index:997;position:fixed;bottom:24px;right:24px;-webkit-box-shadow:0 10px 25px -3px rgba(0,0,0,.75);-moz-box-shadow:0 10px 25px -3px rgba(0,0,0,.75);box-shadow:0 10px 25px -3px rgba(0,0,0,.75)}.center-contents{display:flex;align-items:center;justify-content:center}@media(max-width:768px){div#playbtn.jp-play.play-button--transparent{background:url(https://dragonfm.nl/wp-content/themes/Radio2/player/skin/icon-browsePlayBig.png) center center no-repeat}div#stopbtn.jp-pause.pause-button--transparent{background:url(https://dragonfm.nl/wp-content/themes/Radio2/player/skin/icon-browseStop.png) center center no-repeat}footer.footer-player-dock{margin-top:calc(8px + 8px + 1.4em + 1.4em);margin-top:-moz-calc(8px + 8px + 1.4em + 1.4em);margin-top:-webkit-calc(8px + 8px + 1.4em + 1.4em);margin-top:-o-calc(8px + 8px + 1.4em + 1.4em)}.widget_default_blok_1--hide-mobile{height:0;max-height:0;padding-bottom:0;margin-bottom:0;background:0 0!important}.player-widget__button{position:fixed;bottom:calc(((8px + 8px + 1.8em + 1.8em)/ 2) - 50px);bottom:-moz-calc(((8px + 8px + 1.8em + 1.8em)/ 2) - 50px);bottom:-webkit-calc(((8px + 8px + 1.8em + 1.8em)/ 2) - 50px);bottom:-o-calc(((8px + 8px + 1.8em + 1.8em)/ 2) - 50px);z-index:951;left:-15px}}.player-widget__display{white-space:nowrap;overflow:hidden;margin-left:auto;margin-right:auto;padding:4px;font-weight:400!important}.player-widget__display>*{display:inline-block;position:relative}.player-footer{position:sticky;bottom:0;z-index:950;min-height:75px;padding-top:8px;padding-bottom:8px;padding-right:8px;padding-left:75px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#57007f;-webkit-box-shadow:rgb(0 0 0 / 50%) 0 -6px 11px 0;-moz-box-shadow:rgb(0 0 0 / 50%) 0 -6px 11px 0;box-shadow:rgb(0 0 0 / 50%) 0 -6px 11px 0}.player-footer--docked{-webkit-box-shadow:rgb(0 0 0 / 50%) 0 -10px 11px 0;-moz-box-shadow:rgb(0 0 0 / 50%) 0 -10px 11px 0;box-shadow:rgb(0 0 0 / 50%) 0 -10px 11px 0}.player-footer__display{overflow:hidden;white-space:nowrap;background:0 0;width:100%}.player-footer__display>*{display:inline-block;position:relative;font-size:1.4em;font-weight:400;font-family:verdana;font-style:italic;color:#fff}@media(min-width:769px){.from-medium--hidden{display:none}}</style>');

function recenterChatButton(styleVariables) {
    //here should be code to handle extra overrides. Mappings must be exported in the API.
    let buttonContainer = jQuery(".widget_default_blok_2").find(".widget_button");
    buttonContainer.css("background-size", "cover");
    buttonContainer.find(".widget_button_tekst").css("width", "288px");
}
function addPlayerRounding(styleVariables) {
    jQuery("#sidebar-left").children(".widget_default_blok_1").addClass("from-medium--default-rounding");
}
function removeMobileBodyPadding() {
    jQuery("body").addClass("small--no-bottom-margin");
}
function removeMobileContentPadding() {
    jQuery(".container.page-container").first().addClass("small--no-padding");
    jQuery("#content").addClass("small--no-padding");
}
function removeMobileHeaderPadding() {
    let mainNav = jQuery(".row.main-navigation").first();
    mainNav.addClass("small--no-padding");
    mainNav.children().first().addClass("small--no-padding");
}
function removeMobilePlayerPadding() {
    jQuery("#sidebar-left").addClass("small--no-padding");
}
function removeMobileFooterPadding() {
    jQuery("body").ready(function() {
        jQuery(".footer_compleet_onder").addClass("small--no-bottom-margin");
    });
    jQuery("#footer-row").ready(function() {
        jQuery("#footer-row").find("br").remove();
        jQuery("#footer-row").find(".widget_header_met_opmaak_content_1").eq(1).addClass("remove-vertical-padding");
    });
}
function removeMobileFooterRounding() {
    jQuery(".site-footer").addClass("small--no-rounding");
}
function fullSizeHeaderBanner(styleVariables) {
    let backVar = "#57007F"; // Default
    if(!(styleVariables === undefined)) {
        if(styleVariables.size != 0) {
            let bannerBackgroundOverride = "";
            let temp;
            let doUserOverride = false;
            temp = styleVariables.get("banner-background-color");
            if(!(temp === undefined)) {
                bannerBackgroundOverride += temp;
                doUserOverride = true;
            }
            temp = styleVariables.get("banner-background-image");
            if(!(temp === undefined)) {
                bannerBackgroundOverride += temp;
                doUserOverride = true;
            }
            temp = styleVariables.get("banner-background-position");
            if(!(temp === undefined)) {
                bannerBackgroundOverride += temp;
                doUserOverride = true;
            }
            temp = styleVariables.get("banner-background-size");
            if(!(temp === undefined)) {
                bannerBackgroundOverride += temp;
                doUserOverride = true;
            }
            temp = styleVariables.get("banner-background-repeat");
            if(!(temp === undefined)) {
                bannerBackgroundOverride += temp;
                doUserOverride = true;
            }
            temp = styleVariables.get("banner-background-origin");
            if(!(temp === undefined)) {
                bannerBackgroundOverride += temp;
                doUserOverride = true;
            }
            temp = styleVariables.get("banner-background-clip");
            if(!(temp === undefined)) {
                bannerBackgroundOverride += temp;
                doUserOverride = true;
            }
            temp = styleVariables.get("banner-background-attachment");
            if(!(temp === undefined)) {
                bannerBackgroundOverride += temp;
                doUserOverride = true;
            }
            if(doUserOverride) {
                backVar = temp;
            }
        }
    }
    jQuery("header").ready(function(){
        jQuery("body").prepend('<div id="override-banner" role="banner" style="background:' + backVar + ';"><div class="container"></div></div>');
        jQuery(".navbar.navbar-default").find("img").appendTo("#override-banner > .container");
        jQuery("header").removeAttr("role");
        jQuery(".row.row-with-vspace.site-branding").remove();
        jQuery("header").find(".textwidget.custom-html-widget").addClass("remove-padding remove-margin");
    });
}
function moveFooterFullyDown() {
    jQuery("footer").ready(function(){
        jQuery("footer").appendTo("body");
    });
}
function removeFooterRounding() {
    jQuery("footer").addClass("remove-rounding");
}
function removeBodyOnlyMargin() {
    jQuery("body").addClass("remove-margin");
}
function moveClockIntoPlayer() {
    jQuery("#sidebar-left").find(".PMT_KLOK_widget").prependTo("#sidebar-left > .widget_default_blok_1:eq(0)");
}
function moveChatWidgetIntoPlayer() {
    let chatBlock = jQuery("#sidebar-left > .widget_default_blok_1:eq(1)");
    chatBlock.children().appendTo("#sidebar-left > .widget_default_blok_1:eq(0)");
    chatBlock.remove();
}
function restyleClockResponsive(styleVariables) {
    let restyleClasses = "medium--white-background medium--black-text"; // Default
    let textColor = ""; // Default
    let textSize = "2em"; // Default
    if(!(styleVariables === undefined)) {
        if(styleVariables.size != 0) {
            let temp;
            temp = styleVariables.get("desktop-clock-text-color");
            if(!(temp === undefined)) {
                textColor = temp;
            }
            temp = undefined;
            temp = styleVariables.get("clock-font-size");
            if(!(temp === undefined)) {
                textSize = temp;
            }
            temp = undefined;
            temp = styleVariables.get("clock-restyle-classes");
            if(!(temp === undefined)) {
                restyleClasses = temp;
            }
        }
    }
    jQuery("#sidebar-left").find(".PMT_KLOK_widget").first().addClass(restyleClasses);
    jQuery("#sidebar-left").find(".PMT_KLOK_widget").children().first().css(
        {"color": textColor, "font-size": textSize});
}
function changeChatButtonText(styleVariables) {
    let newText = "Dragon FM Chat"; // Default
    if(!(styleVariables === undefined)) {
        if(styleVariables.size != 0) {
            let temp;
            temp = styleVariables.get("chat-button-text");
            if(!(temp === undefined)) {
                newText = temp;
            }
        }
    }
    let buttonContainer = jQuery(".widget_default_blok_2").find(".widget_button");
    buttonContainer.find("a").first().text(newText);
}
function responsiveDesignMenuOverhaul() {
    jQuery(".navbar-header").remove();
    jQuery("#override-banner").ready(() => {
        jQuery("#override-banner").find("img").attr("style", "height: 100%");
        jQuery("#override-banner").find("img").addClass("header-menu-fix");
        jQuery("#override-banner").addClass("sticky-banner");
        jQuery("#override-banner").children().first().addClass("small--no-padding small--no-margin");
        jQuery("#override-banner").append('<button id="mobileNavToggle" class="hamburger-toggler from-medium--hidden"><span></span></button>');
    });
    jQuery(".navbar.navbar-default").css("margin-bottom", "0px");
    jQuery(".navbar-primary-collapse").ready(() => {
        jQuery(".navbar-primary-collapse").addClass("small--display-block");//override collapse function
    });
    jQuery("#menu-menu-1").ready(() => {
        jQuery("#menu-menu-1").wrap('<div id="navigationMenu"><section class="navigation__menu"></section></div>');
    });
    var menuSelector = undefined;
    // automatic styling through sheet on #navigationmenu
    // CSS feature for menu-menu-1
    // CSS bold font weigth feature of the menu buttons on mobile only
    jQuery("#navigationMenu").ready(() => {
        menuSelector = jQuery("#navigationMenu");
        jQuery("#menu-menu-1").find("*").removeAttr("data-toggle");
        jQuery("#menu-menu-1").find(".menu-item-has-children").each(function(index, element){
            let classList = jQuery(element).attr("class");
            //match the 'menu-item-[number]' as a way to create a selector for the collapsible menus 
            let matchResult = classList.match(/menu-item-[0-9]+/g);
            if(matchResult.length > 0){
                classList = "." + matchResult[0] + " > .collapse";
                jQuery(element).attr("data-target", classList);
                jQuery(element).removeAttr("data-dropdown");
                jQuery(element).attr("data-toggle", "collapse");
                jQuery(element).children("ul").addClass("collapse dropdown--responsive");
                jQuery(element).find("li").addClass("dropdow__item--responsive");
                let displayText = jQuery(element).children("a").text();
                let hyperlink = jQuery(element).children("a").attr("href");
                jQuery(element).children("a").replaceWith('<a><div style="display: inline-block" onclick="location = \'' + hyperlink +'\'">' + displayText + '</div><span style="display: inline-block; margin-top: 8px; float: right; transition: transform .3s ease-out;" class="caret" onclick="jQuery(this).toggleClass(\'rotate--half\')"></span> </a>');
                jQuery(element).children("ul").removeClass("dropdown-menu");
                jQuery(element).find("li").css("display", "block");
            }
        });
        jQuery("#navigationMenu").append('<section class="from-medium--hidden"><div style="display:flex;flex-wrap:wrap;justify-content:center;align-items:flex-end;padding-top:10px"><b>Volg ons</b></div><div style="display:flex;flex-wrap:wrap;justify-content:center;align-items:flex-end;padding-top:10px"><a href="https://open.spotify.com/user/hpx3z64qv46xf6lc3be3biihq?si=f5654f24f7a44d4c" target="_blank" rel="noopener noreferrer" style="text-decoration:none;border:0;width:53px;height:53px;padding:2px;margin:5px;color:white !important;"><svg class="niftybutton-spotify" style="display:block;fill:currentColor" data-donate="true" data-tag="spo" data-name="Spotify" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 78c-98.3 0-178 79.7-178 178 0 98.31 79.7 178 178 178 98.31 0 178-79.69 178-178 0-98.3-79.69-178-178-178zm81.63 256.73a11.09 11.09 0 0 1-15.26 3.68c-41.8-25.53-94.4-31.31-156.37-17.16a11.1 11.1 0 0 1-4.93-21.64c67.8-15.49 125.96-8.82 172.88 19.86a11.1 11.1 0 0 1 3.68 15.26zm21.79-48.47a13.88 13.88 0 0 1-19.1 4.57c-47.84-29.4-120.77-37.92-177.36-20.74a13.9 13.9 0 0 1-17.32-9.25 13.9 13.9 0 0 1 9.25-17.3c64.65-19.62 145.01-10.12 199.96 23.64a13.87 13.87 0 0 1 4.56 19.08zm1.87-50.47c-57.37-34.07-152.02-37.2-206.8-20.58a16.65 16.65 0 1 1-9.66-31.87c62.88-19.08 167.4-15.4 233.45 23.81a16.63 16.63 0 0 1 5.82 22.82 16.63 16.63 0 0 1-22.8 5.82h-.01z"></path></svg></a><a href="https://www.facebook.com/RadioDragonFM" target="_blank" rel="noopener noreferrer" style="text-decoration:none;border:0;width:53px;height:53px;padding:2px;margin:5px;color:white !important;"><svg class="niftybutton-facebook" style="display:block;fill:currentColor" data-tag="fac" data-name="Facebook" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M211.9 197.4h-36.7v59.9h36.7V433.1h70.5V256.5h49.2l5.2-59.1h-54.4c0 0 0-22.1 0-33.7 0-13.9 2.8-19.5 16.3-19.5 10.9 0 38.2 0 38.2 0V82.9c0 0-40.2 0-48.8 0 -52.5 0-76.1 23.1-76.1 67.3C211.9 188.8 211.9 197.4 211.9 197.4z"></path></svg></a><a href="https://www.instagram.com/RadioDragonFM" target="_blank" rel="noopener noreferrer" style="text-decoration:none;border:0;width:53px;height:53px;padding:2px;margin:5px;color:white !important;"><svg class="niftybutton-instagram" style="display:block;fill:currentColor" data-tag="ins" data-name="Instagram" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 109.3c47.8 0 53.4 0.2 72.3 1 17.4 0.8 26.9 3.7 33.2 6.2 8.4 3.2 14.3 7.1 20.6 13.4 6.3 6.3 10.1 12.2 13.4 20.6 2.5 6.3 5.4 15.8 6.2 33.2 0.9 18.9 1 24.5 1 72.3s-0.2 53.4-1 72.3c-0.8 17.4-3.7 26.9-6.2 33.2 -3.2 8.4-7.1 14.3-13.4 20.6 -6.3 6.3-12.2 10.1-20.6 13.4 -6.3 2.5-15.8 5.4-33.2 6.2 -18.9 0.9-24.5 1-72.3 1s-53.4-0.2-72.3-1c-17.4-0.8-26.9-3.7-33.2-6.2 -8.4-3.2-14.3-7.1-20.6-13.4 -6.3-6.3-10.1-12.2-13.4-20.6 -2.5-6.3-5.4-15.8-6.2-33.2 -0.9-18.9-1-24.5-1-72.3s0.2-53.4 1-72.3c0.8-17.4 3.7-26.9 6.2-33.2 3.2-8.4 7.1-14.3 13.4-20.6 6.3-6.3 12.2-10.1 20.6-13.4 6.3-2.5 15.8-5.4 33.2-6.2C202.6 109.5 208.2 109.3 256 109.3M256 77.1c-48.6 0-54.7 0.2-73.8 1.1 -19 0.9-32.1 3.9-43.4 8.3 -11.8 4.6-21.7 10.7-31.7 20.6 -9.9 9.9-16.1 19.9-20.6 31.7 -4.4 11.4-7.4 24.4-8.3 43.4 -0.9 19.1-1.1 25.2-1.1 73.8 0 48.6 0.2 54.7 1.1 73.8 0.9 19 3.9 32.1 8.3 43.4 4.6 11.8 10.7 21.7 20.6 31.7 9.9 9.9 19.9 16.1 31.7 20.6 11.4 4.4 24.4 7.4 43.4 8.3 19.1 0.9 25.2 1.1 73.8 1.1s54.7-0.2 73.8-1.1c19-0.9 32.1-3.9 43.4-8.3 11.8-4.6 21.7-10.7 31.7-20.6 9.9-9.9 16.1-19.9 20.6-31.7 4.4-11.4 7.4-24.4 8.3-43.4 0.9-19.1 1.1-25.2 1.1-73.8s-0.2-54.7-1.1-73.8c-0.9-19-3.9-32.1-8.3-43.4 -4.6-11.8-10.7-21.7-20.6-31.7 -9.9-9.9-19.9-16.1-31.7-20.6 -11.4-4.4-24.4-7.4-43.4-8.3C310.7 77.3 304.6 77.1 256 77.1L256 77.1z"></path><path d="M256 164.1c-50.7 0-91.9 41.1-91.9 91.9s41.1 91.9 91.9 91.9 91.9-41.1 91.9-91.9S306.7 164.1 256 164.1zM256 315.6c-32.9 0-59.6-26.7-59.6-59.6s26.7-59.6 59.6-59.6 59.6 26.7 59.6 59.6S288.9 315.6 256 315.6z"></path><circle cx="351.5" cy="160.5" r="21.5"></circle></svg></a><a href="mailto:radio@dragonfm.nl" target="_blank" rel="noopener noreferrer" style="text-decoration:none;border:0;width:53px;height:53px;padding:2px;margin:5px;color:white !important;"><svg class="niftybutton-email" style="display:block;fill:currentColor" data-donate="true" data-tag="ema" data-name="Email" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M101.3 141.6v228.9h0.3 308.4 0.8V141.6H101.3zM375.7 167.8l-119.7 91.5 -119.6-91.5H375.7zM127.6 194.1l64.1 49.1 -64.1 64.1V194.1zM127.8 344.2l84.9-84.9 43.2 33.1 43-32.9 84.7 84.7L127.8 344.2 127.8 344.2zM384.4 307.8l-64.4-64.4 64.4-49.3V307.8z"></path></svg></a><a href="https://www.youtube.com/channel/UCfVi5JAqbYZd2DzhCr5hHyw" target="_blank" rel="noopener noreferrer" style="text-decoration:none;border:0;width:53px;height:53px;padding:2px;margin:5px;color:white !important;"><svg class="niftybutton-youtube" style="display:block;fill:currentColor" data-donate="true" data-tag="you" data-name="YouTube" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M422.6 193.6c-5.3-45.3-23.3-51.6-59-54 -50.8-3.5-164.3-3.5-215.1 0 -35.7 2.4-53.7 8.7-59 54 -4 33.6-4 91.1 0 124.8 5.3 45.3 23.3 51.6 59 54 50.9 3.5 164.3 3.5 215.1 0 35.7-2.4 53.7-8.7 59-54C426.6 284.8 426.6 227.3 422.6 193.6zM222.2 303.4v-94.6l90.7 47.3L222.2 303.4z"></path></svg></a></div></section>');
    });
    var isMenuOpen = false;
    jQuery(".hamburger-toggle").ready(() => {
        jQuery(".hamburger-toggler").click(function() {
            jQuery(this).toggleClass("active");
            
            if(isMenuOpen){
                let menuWidth = "-" + menuSelector.outerWidth() + "px";
                menuSelector.animate({
                    left: menuWidth
                },"fast");
                menuSelector.removeClass("navigation-unfolds");
                menuSelector.addClass("navigation-folds");
                isMenuOpen = false;
            } 
            else {
                menuSelector.animate({
                    left: "0px"
                },"fast");
                menuSelector.removeClass("navigation-folds");
                menuSelector.addClass("navigation-unfolds");
                isMenuOpen = true;
            }
            jQuery("body").toggleClass("lock-scroll");
        });
    });
}
function fixExternalContent(){
    jQuery("#content").ready(function() {
        jQuery("#content").find("section[data-kc-fullwidth='row']").css({
            "left": "unset",
            "padding-left": "unset",
            "padding-right": "unset"
        });
    });
}
function removeResponsiveMenuSelect(){
    jQuery(".responsiveMenuSelect").remove();
}
function removeResponsiveSelectClass() {
    jQuery(".responsiveSelectFullMenu").removeClass("responsiveSelectFullMenu");
}
function fixTopMargin(){
    jQuery("#content").addClass("margin-top-content-fix");
}
function setViewToPageTop(){
    window.scrollTo(0, 0);
}
function removeRegularMobileChat() {
    jQuery("#sidebar-left > .widget_default_blok_1 > .uppercase").last().addClass("small--hidden");
    jQuery("#sidebar-left > .widget_default_blok_1 > .widget_default_blok_2").addClass("small--hidden");
}
function addFloatingChatButton() {
    jQuery("footer.site-footer").before('<a id="floatingChatButton" class="button--highlight center-contents from-medium--hidden" href="/chatroom" onclick="window.open(this.href, this.target, \'toolbar=0,location=0,menubar=0,scrollbars=0,resizable=0\'); return false;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="20px" y="25%" width="35px" height="40px" style="fill: white;/* background-color: white; */" viewBox="0 0 554.962 554.962" xml:space="preserve"><g><g><path d="M530.5,148.633H404.826v162.155c0,23.611-19.211,42.822-42.822,42.822H168.49v54.297    c0,13.506,10.949,24.461,24.461,24.461h190.118l79.443,66.354c10.367,8.66,15.942,5.098,12.454-7.949l-15.521-58.012    c-0.036-0.135-0.109-0.258-0.146-0.393h71.2c13.507,0,24.462-10.949,24.462-24.461V173.088    C554.955,159.582,544.007,148.633,530.5,148.633z"/><path d="M24.461,335.243h37.394c-0.037,0.135-0.11,0.258-0.147,0.393l-15.521,58.012c-2.203,8.225-0.795,12.68,3.134,12.68    c2.307,0,5.483-1.529,9.314-4.73l79.444-66.354h30.417h193.515c13.507,0,24.461-10.947,24.461-24.461V148.633V75.97    c0-13.507-10.948-24.461-24.461-24.461H24.461C10.955,51.509,0,62.458,0,75.97v234.812C0,324.296,10.949,335.243,24.461,335.243z"/></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></a>');
}
function removeAlternateSourcesMobile() {
    jQuery(".player_links").addClass("small--hidden");
}

// Required global variables to overwrite old player system.
var artist;
var song;
var isNewSongPlaying = false;
var mobileFooterPlayerBreakpoint = 769;//TODO

function replaceIFrameMarquee(styleVariables) {
    let songInformationFontFamily = "verdana, arial, Helvetica, sans-serif";
    let songInformationFontSize = "1.4em";
    let songInformationTextColor = "#ffffff";
    let songInformationFontStyle = "italic";
    jQuery(".now_playing_scroler").replaceWith(
    `<div id="songContainerTop" class="now_playing_scroler player-widget__display">
    <span id="songDisplayTop" 
    style="font-family:${songInformationFontFamily};
    font-size:${songInformationFontSize};
    color:${songInformationTextColor} !important;
    font-style:${songInformationFontStyle};">Ophalen...</span></div>`);
}

function addMobilePlayer(styleVariables) {
    if(jQuery("body").hasClass("home")) {//remember add negation
        jQuery(".container.page-container").before(`<footer id="mobilePlayer" class="player-footer from-medium--hidden">
        <div id="artistNameContainer" class="player-footer__display">
            <span id="artistNameDisplay"></span>
        </div>
        <div id="songTitleContainer" class="player-footer__display">
        <span id="songTitleDisplay"></span></footer>
        </div>`);
        jQuery("#jp_interface_1").addClass("player-widget__button");
        //
        /////// Surgical operation
        //
        jQuery("#playbtn").addClass("play-button--transparent");
        jQuery("#stopbtn").addClass("pause-button--transparent");
        //jQuery("footer.site-footer").addClass("footer-player-dock");
        addMobilePlayerScroll();
    }
}
function removeSidebarForMobile(styleVariables){
    if(jQuery("body").hasClass("home")) {//remember add negation
        //jQuery("#songContainerTop").ready(function(){
        jQuery("#songContainerTop").addClass("small--hidden");
        //});
        jQuery(".now_playing_scroler.lazyloaded").addClass("small--hidden");
        jQuery(".PMT_KLOK_widget").addClass("small--hidden");
        jQuery(".DJ_planner_1").addClass("small--hidden");
        jQuery("#sidebar-left > .widget_default_blok_1 > .uppercase").addClass("small--hidden");
        let queryCache = jQuery("#sidebar-left > .widget_default_blok_1");
        queryCache.addClass("widget_default_blok_1--hide-mobile");
        queryCache = queryCache.children(".widget_default_blok_1");
        queryCache.children("div").first().addClass("small--hidden");
        queryCache.addClass("widget_default_blok_1--hide-mobile");
        
    }
}
function reinstateSongInformationUpdate(styleVariables){
    syncSongInformation(styleVariables);
    let loopTime = 10000;
    if (!(styleVariables === undefined)){
        let temp = undefined;
        temp = styleVariables.get("songInformationUpdateInterval");
        if(!(temp === undefined)){
            loopTime = temp;
        }
    }
    window.setInterval(syncSongInformation, loopTime, styleVariables);
}
function animateSongInformationSimple(styleVariables){
    let bootstrapProces;
    jQuery("#songDisplayTop").css("left", "100%");
    //check every 1 second or so
    bootstrapProces = window.setInterval(function checkInitialLoad(){
        if(isNewSongPlaying) {
            window.clearInterval(bootstrapProces);
            marqueeReplacementAnimationLoop()
        }
    }, 1000);  
}
function animateSongInformationComplex(styleVariables){
    let bootstrapProces;
    jQuery("#songDisplayTop").css("left", "100%");
    jQuery("#artistNameDisplay").css("left", "100%");
    jQuery("#songTitleDisplay").css("left", "100%");
    //check every 1 second or so
    bootstrapProces = window.setInterval(function checkInitialLoad(){
        if(isNewSongPlaying) {
            window.clearInterval(bootstrapProces);
            if(jQuery("body").hasClass("home")) {//remember add negation
                responsiveSongInformationLoop();//start real animation loop
            } else {
                marqueeReplacementAnimationLoop()
            }
        }
    }, 1000);  
}
function ensureFloatingButtonCompatability(){
    jQuery("head").append('<style>a#floatingChatButton {margin-top: calc(8px + 8px + 1.4em + 1.4em + 16px);margin-top: -moz-calc(8px + 8px + 1.4em + 1.4em  + 16px);margin-top: -webkit-calc(8px + 8px + 1.4em + 1.4em  + 16px);margin-top: -o-calc(8px + 8px + 1.4em + 1.4em  + 16px);}</style>');
}

var latestBody = [removeMobileBodyPadding, removeBodyOnlyMargin];
var latestHeader = [fullSizeHeaderBanner, setViewToPageTop, responsiveDesignMenuOverhaul];
var latestContent = [removeResponsiveMenuSelect, fixTopMargin, removeMobileContentPadding, removeResponsiveSelectClass, fixExternalContent, removeRegularMobileChat];
var latestPlayer = [removeMobilePlayerPadding, removeAlternateSourcesMobile, recenterChatButton, moveClockIntoPlayer, 
    moveChatWidgetIntoPlayer, addPlayerRounding, restyleClockResponsive, changeChatButtonText, replaceIFrameMarquee, 
    reinstateSongInformationUpdate, ensureFloatingButtonCompatability];
var latestFooter = [removeMobileFooterPadding, removeFooterRounding, moveFooterFullyDown, addFloatingChatButton, addMobilePlayer, animateSongInformationComplex, removeSidebarForMobile];

//
// tasks: a list of functions to perform
// OPTIONAL | styleVariables: a map {string, string} of a propery to be overridden 
function override(tasks, styleVariables) {
    jQuery(tasks).each(function(key, val){
        val(styleVariables);
    });
}

/*==== helper functions ====*/
function syncSongInformation(styleVariables) {
    fetchSongInformation(function(text) {
        //executed on another time.
        updateSongInformation(extractSongDetailInformation(text), styleVariables);
        isNewSongPlaying = true;
    });
}
// onCompletion: a function that executes on completion of the fetch and passes the result text into it
function fetchSongInformation(onCompletion) {
    fetch("https://dragonfm.nl/wp-content/themes/Radio2/IcecastHK-Curent-song.php").then(
        function(response) {
            response.text().then(
                function(text) {
                    onCompletion(text);
                });
        });
}
function extractSongDetailInformation(html){
    let songDisplayStartIndex = html.lastIndexOf('">') + 2;
    let alternateIndex = html.indexOf("'>") + 2; //TODO
    let songDisplayEndIndex = html.indexOf("</marq");
    let information = html.substring(alternateIndex, songDisplayEndIndex + 1);
    return information;
}
// Sets song information global variables based on song input
// songInformation: a string containing both artist and song name seperated with a special string
// styleVariables: the key 'songSeparator' is used to split the songInformation
// returns: boolean whether the song has changed (true for change, false otherwise)
function updateSongInformation(songInformation, styleVariables){
    let result = false;
    let middle = songInformation.indexOf(" - ");// custom
    let tempString = songInformation.substring(0, middle);
    if(tempString === artist){
        let tempString2 = songInformation.substring(middle + 3, songInformation.length - 1);//take custom into account
        if(tempString !== song){
            song = tempString2;
        }
        //here escapes when the song hasnt changed
    }
    else{
        artist = tempString;
        tempString = songInformation.substring(middle + 3, songInformation.length - 1);//take custom into account
        song = tempString;
    }
    return result;
}

// Simply adds a scroll function for managing the docking of the mobile player and managing chat button position.
function addMobilePlayerScroll(){
    jQuery(window).scroll(function(){
        if(window.innerWidth < mobileFooterPlayerBreakpoint){
            let playerHeight = jQuery('#mobilePlayer').outerHeight();
            let position =  jQuery(window).scrollTop() + $(window).innerHeight();
            let condition = jQuery('#footer-row').offset().top;
            let difference = position - condition;
            if(position > condition){
                //jQuery("#mobilePlayer").css("bottom", (difference - 1) + "px");//maybe add one for line prevention?
                //jQuery("#mobilePlayer").addClass("player-footer--docked");
                //jQuery("#mobilePlayer").css("z-index", "-1");
                jQuery("#jp_interface_1").css("bottom", (
                    difference + (playerHeight/2 - 50)) + 
                    "px");
                let factor = (playerHeight + 16)/2 - 6;//notice, 12/2 = 6, has to do with custom as well.
                if (difference < 91) { //ensure custom is possible.
                    jQuery("#floatingChatButton").css("bottom", (
                        factor * Math.cos(0.035 * difference) + factor + 12
                    ) + "px");//pre calculated period variable, has to do with button size.
                } else {
                    jQuery("#floatingChatButton").css("bottom", "12px");//not sure
                }
            }
            else{
                //jQuery("#mobilePlayer").css("bottom", "0px")
                //jQuery("#mobilePlayer").removeClass("player-footer--docked");
                //jQuery("#mobilePlayer").css("z-index", "950");
                jQuery("#jp_interface_1").css("bottom", "");
                jQuery("#floatingChatButton").css("bottom", (playerHeight + 16) + "px"); 
            }
        }
    });
}

var topTextPixelLength;
var topScrollDuration;
var artistTextPixelLength;
var artistScrollDuration;
var songTextPixelLength;
var songScrollDuration;

function marqueeReplacementAnimationLoop(){
    jQuery("#songDisplayTop").css("left", "100%");
    if(isNewSongPlaying) {
        jQuery("#songDisplayTop").text(artist + " - " + song);
        let length = jQuery("#songDisplayTop").width();
        topTextPixelLength = "-" + length + "px";
        topScrollDuration = ((jQuery("#songContainerTop").innerWidth() + length) / 5 ) * 85;
        isNewSongPlaying = false;
    }
    jQuery("#songDisplayTop").animate({left: topTextPixelLength
    }, {
        duration: topScrollDuration, 
        easing: 'linear', 
        complete: marqueeReplacementAnimationLoop
    });
}
function responsiveSongInformationLoop(){
    const textProtusionLengthExtra = 3;
    if(window.innerWidth < mobileFooterPlayerBreakpoint){
        
        if(isNewSongPlaying) {
            jQuery("#artistNameDisplay").text(artist);
            jQuery("#songTitleDisplay").text(song);
            let length = jQuery("#artistNameDisplay").width();
            length += textProtusionLengthExtra;
            artistTextPixelLength = "-" + length + "px";
            artistScrollDuration = ((jQuery("#artistNameContainer").innerWidth() + length) / 5 ) * 85;
            length = jQuery("#songTitleDisplay").width();
            length += textProtusionLengthExtra;
            songTextPixelLength = "-" + length + "px";
            songScrollDuration = ((jQuery("#songTitleContainer").innerWidth() + length) / 5 ) * 85;
            isNewSongPlaying = false;
        }
        jQuery("#artistNameDisplay").animate({left: artistTextPixelLength
        }, {
            duration: artistScrollDuration, 
            easing: 'linear',
            complete: function() {
                jQuery("#artistNameDisplay").css("left", "100%");
            }
        });
        jQuery("#songTitleDisplay").animate({left: songTextPixelLength
        }, {
            duration: songScrollDuration, 
            easing: 'linear',
            complete: function() {
                jQuery("#songTitleDisplay").css("left", "100%");
            }
        });
        setTimeout(responsiveSongInformationLoop,
            Math.max(artistScrollDuration, songScrollDuration) + 10);
    } else {
        jQuery("#songDisplayTop").css("left", "100%");
        if(isNewSongPlaying) {
            jQuery("#songDisplayTop").text(artist + " - " + song);
            let length = jQuery("#songDisplayTop").width();
            topTextPixelLength = "-" + jQuery("#songDisplayTop").width() + "px";
            topScrollDuration = ((jQuery("#songContainerTop").innerWidth() + length) / 5 ) * 85;
            isNewSongPlaying = false;
        }
        jQuery("#songDisplayTop").animate({left: topTextPixelLength
        }, {
            duration: topScrollDuration, 
            easing: 'linear', 
            complete: responsiveSongInformationLoop
        });
    }
}
